# Business Logic

## Exploit
- **تغییر دادن قیمت**
  - در مراحل خرید، قیمت را تغییر می دهیم، تا جنس با قیمت تغییر یافته به سبد خرید اضافه گردد.
- **تعداد منفی سفارش**
  - جنس اصلی را سفارش داده، سپس جنس های دیگر را با تعداد منفی سفارش می دهیم، تا قیمت آنها منفی شده و مجموع قیمت کل نزدیک به صفر شود.
- **سرریز شدن متغییر قیمت**
  - با ارسال تعداد زیاد درخواست خرید یک کالا از طریق حالت Null payloads دربخش Intruder، قیمت را منفی می کنیم (سقف int پر می شود)، سپس با اضافه کردن کالاهای دیگر قیمت را به نزدیک صفر می رسانیم.
  - سقف تعداد در یک درخواست را با بررسی خطای برگشتی از بخش Repeater پیدا می کنیم.
  - در بخش Countinue می توانیم منفی شدن را بفهمیم.
  - در بخش Generate می توانیم تعداد لازم برای منفی شدن نزدیک به صفر را وارد کنیم.
- **استفاده مجدد از کوپن تخفیف**
  - از هر کوپن تخفیف فقط یک بار می توان استفاده کرد.
  - حال اگر دو کوپن تخفیف داشته باشیم، می توانیم با پست سر هم زدن آن ها، این کنترل را بای پاس کنیم .


## Business Logic Data Validation
- چک کردن صحت کدملی، ایمیل، کدپستی
- هدف کاهش حجم دیتابیس است تا دیتای فیک نداشته باشیم

## Ability to forge Request
- اضافه کردن فیلد discount=10% و گرفتن تخفیف زمانی که زمان تخفیف به پایان رسیده است

## Integrity Check
- فیلدهای مخفی شده نباید در سمت سرور پردازش شوند و بر اساس آن ها تصمیمی گرفته شود

## Process Timing
- حذف محصول از سبد خرید پس از زمان مشخص
- صدور خطا دیتابیس پس از ماندن طولانی مدت در یکی از مراحل فرآیند خرید

## Number of times a Function can be Used limits
- محدود نمودن فراخوانی تابع موجودی بیش از 5 بار برای جلوگیری از Dictionary Attack و Brute Force

## The circumvention of Workflows
- ممکن است در بخش Edit Profile بتوانیم مکانیزم های امنیتی ای که در بخش Create Profile وجود دارد را دور بزنیم

## Defenses Against Application Mis-Use
- بلاک کردن کاربری که از کاراکترهای غیرمجاز استفاده کرده است، برای یک زمان مشخص
- معادل OWASP A10 با نام Insufficient Logging and Monitoring می باشد

## Upload of Unexpected File Types
- فایل های با پسوندهای غیرمجاز نباید آپلود شوند، مانند Shell ای که به صورت mypic.php.gif آپلود کردیم

## Upload of Malicious Files
- محتوای فایل هم علاوه بر extension باید چک شود که از طریق signature می باشد
- مانند قرار دادن کد PHP در بخش comment عکس
